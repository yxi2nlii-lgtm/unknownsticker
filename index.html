<!DOCTYPE html>
<html lang="zh-CN">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>åŠ¨æ€è¡¨æƒ… - çŠ¶æ€è®°å¿†ä¸æŸ”å’Œé˜´å½±</title>
Â  Â  <style>
Â  Â  Â  Â  /* ç»Ÿä¸€çº¿æ¡ç²—ç»†å˜é‡ */
Â  Â  Â  Â  :root {
Â  Â  Â  Â  Â  Â  --line-thickness: 10px;
Â  Â  Â  Â  Â  Â  --eye-height: 35px;
Â  Â  Â  Â  Â  Â  /* åˆå§‹é¢œè‰²ï¼šå®Œå…¨é€æ˜ */
Â  Â  Â  Â  Â  Â  --face-color: transparent;Â 
Â  Â  Â  Â  Â  Â  --max-move-distance: 30px;Â 
Â  Â  Â  Â  Â  Â  --max-squeeze-scale: 0.90;Â 
Â  Â  Â  Â  Â  Â  --max-stretch-scale: 1.05;
Â  Â  Â  Â  Â  Â  --face-shift-ratio: 0.15;Â 
Â  Â  Â  Â  Â  Â  --face-padding: 50px;Â 
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* 1. é¡µé¢æ•´ä½“æ ·å¼ */
Â  Â  Â  Â  body, html {
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  padding: 0;
Â  Â  Â  Â  Â  Â  height: 100%;
Â  Â  Â  Â  Â  Â  width: 100%;Â 
Â  Â  Â  Â  Â  Â  display: flex;Â 
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  /* èƒŒæ™¯è‰²è®¾ç½®ä¸ºç™½è‰² */
Â  Â  Â  Â  Â  Â  background-color: #FFFFFF;Â 
Â  Â  Â  Â  Â  Â  padding: var(--face-padding);
Â  Â  Â  Â  Â  Â  box-sizing: border-box;Â 
Â  Â  Â  Â  Â  Â  position: relative;Â 
Â  Â  Â  Â  Â  Â  overflow: hidden;Â 
Â  Â  Â  Â  }

Â  Â  Â  Â  /* 2. è¡¨æƒ…å®¹å™¨ (å¤§åœ†è„¸) */
Â  Â  Â  Â  .emoji-container {
Â  Â  Â  Â  Â  Â  width: 80vw;Â 
Â  Â  Â  Â  Â  Â  max-width: 300px;Â 
Â  Â  Â  Â  Â  Â  height: auto;Â 
Â  Â  Â  Â  Â  Â  aspect-ratio: 1 / 1;Â 
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  background-color: var(--face-color); /* åˆå§‹é€æ˜ */
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  border-radius: 50%;Â 
Â  Â  Â  Â  Â  Â  position: relative;
Â  Â  Â  Â  Â  Â  box-shadow: none; /* åˆå§‹æ— é˜´å½±ï¼Œç”±JSåŠ¨æ€è®¾ç½® */
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  /* ä¸ºé¢œè‰²å˜åŒ–å’Œé€æ˜åº¦å˜åŒ–æ·»åŠ è¿‡æ¸¡æ•ˆæœ */
Â  Â  Â  Â  Â  Â  transition: transform 0.1s ease-out, box-shadow 0.1s ease-out, background-color 0.5s ease;Â 
Â  Â  Â  Â  Â  Â  overflow: hidden;Â 
Â  Â  Â  Â  }

Â  Â  Â  Â  /* 3. äº”å®˜å®¹å™¨ (å†…éƒ¨ç§»åŠ¨å±‚) */
Â  Â  Â  Â  .features-wrapper {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  top: 0;
Â  Â  Â  Â  Â  Â  left: 0;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  height: 100%;
Â  Â  Â  Â  Â  Â  transition: transform 0.1s ease-out;Â 
Â  Â  Â  Â  Â  Â  opacity: 1;Â 
Â  Â  Â  Â  }

Â  Â  Â  Â  /* 4. çœ¼ç›å’Œå˜´å·´çš„é€šç”¨æ ·å¼ */
Â  Â  Â  Â  .eye, .mouth {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  background-color: black;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* 5. çœ¼ç›ã€å˜´å·´ã€çœ¨çœ¼åŠ¨ç”»ç­‰æ ·å¼ (ä¿æŒä¸å˜) */
Â  Â  Â  Â  .eye {
Â  Â  Â  Â  Â  Â  width: var(--line-thickness);Â 
Â  Â  Â  Â  Â  Â  height: var(--eye-height);Â 
Â  Â  Â  Â  Â  Â  top: 35%;Â 
Â  Â  Â  Â  Â  Â  animation: blink 4s infinite;Â 
Â  Â  Â  Â  }

Â  Â  Â  Â  .left-eye {
Â  Â  Â  Â  Â  Â  left: 35%;
Â  Â  Â  Â  Â  Â  transform: translateX(-50%);
Â  Â  Â  Â  }

Â  Â  Â  Â  .right-eye {
Â  Â  Â  Â  Â  Â  right: 35%;
Â  Â  Â  Â  Â  Â  transform: translateX(50%);
Â  Â  Â  Â  }

Â  Â  Â  Â  .mouth {
Â  Â  Â  Â  Â  Â  width: 80px;
Â  Â  Â  Â  Â  Â  height: 80px;
Â  Â  Â  Â  Â  Â  border: var(--line-thickness) solid black;Â 
Â  Â  Â  Â  Â  Â  border-color: transparent transparent black transparent;Â 
Â  Â  Â  Â  Â  Â  border-radius: 50%;
Â  Â  Â  Â  Â  Â  bottom: 25%;
Â  Â  Â  Â  Â  Â  right: 30%;Â 
Â  Â  Â  Â  Â  Â  transform: rotate(-45deg);Â 
Â  Â  Â  Â  Â  Â  background-color: transparent;Â 
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  @keyframes blink {
Â  Â  Â  Â  Â  Â  0%, 45%, 100% {
Â  Â  Â  Â  Â  Â  Â  Â  height: var(--eye-height);
Â  Â  Â  Â  Â  Â  Â  Â  transform: translateX(-50%);Â 
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  50%, 52% {
Â  Â  Â  Â  Â  Â  Â  Â  height: var(--line-thickness);
Â  Â  Â  Â  Â  Â  Â  Â  transform: translate(-50%, calc((var(--eye-height) - var(--line-thickness)) / 2));
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  @keyframes shake {
Â  Â  Â  Â  Â  Â  0% { transform: scale(1.0); }
Â  Â  Â  Â  Â  Â  50% { transform: scale(0.98); }Â 
Â  Â  Â  Â  Â  Â  100% { transform: scale(1.0); }Â 
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .click-shake {
Â  Â  Â  Â  Â  Â  animation: shake 0.2s ease-in-out;Â 
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body>
Â  Â  <div style="position: absolute; top: 10px; color: #555; font-size: 14px;" id="blynk-status">Blynk Status: Idle</div>
    
Â  Â  <div class="emoji-container" id="emojiContainer">
Â  Â  Â  Â  <div class="features-wrapper" id="featuresWrapper">
Â  Â  Â  Â  Â  Â  <div class="eye left-eye"></div>
Â  Â  Â  Â  Â  Â  <div class="eye right-eye"></div>
Â  Â  Â  Â  Â  Â  <div class="mouth"></div>
Â  Â  Â  Â  </div>
Â  Â  </div>
Â  Â Â 
Â  Â  <script>
Â  Â  Â  Â  const container = document.getElementById('emojiContainer');
Â  Â  Â  Â  const wrapper = document.getElementById('featuresWrapper');
Â  Â  Â  Â  const root = document.documentElement;Â 
        const blynkStatusElement = document.getElementById('blynk-status');

Â  Â  Â  Â  // --- Blynk API å’ŒçŠ¶æ€å¸¸é‡ ---
        // ğŸš¨ ç¡®ä¿ä»¥ä¸‹ä¸‰ä¸ªå¸¸é‡ä¸æ‚¨çš„ESP32é…ç½®ä¸€è‡´ ğŸš¨
        const AUTH_TOKEN = 'OqSFS2EppKQRi0DYBOTFNEQgW7pljRjT';Â 
        const BLYNK_HOST = 'blynk.cloud';Â 
        const VIRTUAL_PIN = 'v1';Â 
        const PICKUP_ANGLE = 120; // èˆµæœºç›®æ ‡è§’åº¦
        const RETURN_ANGLE = 0; // é‡ç½®äº‘ç«¯çŠ¶æ€è§’åº¦

        // --- é¢œè‰²å’Œè¡¨æƒ…çŠ¶æ€å¸¸é‡ ---
Â  Â  Â  Â  const TARGET_HUE = 0;Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  const TARGET_SATURATION = 100;Â Â 
Â  Â  Â  Â  const TARGET_LIGHTNESS = 70;Â  Â Â 

Â  Â  Â  Â  const MAX_CLICKS = 10;Â  Â  Â Â 
Â  Â  Â  Â  const DECAY_DURATION_SEC = 30;Â 
Â  Â  Â  Â  const DECAY_RATE_PER_SEC = MAX_CLICKS / DECAY_DURATION_SEC;Â 

Â  Â  Â  Â  // --- çŠ¶æ€å˜é‡ ---
Â  Â  Â  Â  let clickCount = 0;Â 
Â  Â  Â  Â  let decayInterval = null;Â 
Â  Â  Â  Â Â 
Â  Â  Â  Â  // --- ç§»åŠ¨å’Œèšæ‹¢å¸¸é‡ (ä»CSSè·å–) ---
Â  Â  Â  Â  const maxDistance = parseFloat(getComputedStyle(root).getPropertyValue('--max-move-distance')) || 30;
Â  Â  Â  Â  const maxSqueezeScale = parseFloat(getComputedStyle(root).getPropertyValue('--max-squeeze-scale')) || 0.90;
Â  Â  Â  Â  const maxStretchScale = parseFloat(getComputedStyle(root).getPropertyValue('--max-stretch-scale')) || 1.05;
Â  Â  Â  Â  const faceShiftRatio = parseFloat(getComputedStyle(root).getPropertyValue('--face-shift-ratio')) || 0.15;


Â  Â  Â  Â  // --- çŠ¶æ€å­˜å‚¨å‡½æ•° ---
Â  Â  Â  Â  function saveState() {
Â  Â  Â  Â  Â  Â  localStorage.setItem('emojiClickCount', clickCount);
Â  Â  Â  Â  Â  Â  localStorage.setItem('emojiLastUpdateTime', Date.now());
Â  Â  Â  Â  }


Â  Â  Â  Â  // --- é¢œè‰²é€»è¾‘å‡½æ•° ---
Â  Â  Â  Â  function updateColor() {
Â  Â  Â  Â  Â  Â  const progress = clickCount / MAX_CLICKS; // 0 åˆ° 1

Â  Â  Â  Â  Â  Â  const currentSaturation = Math.round(TARGET_SATURATION * progress);
Â  Â  Â  Â  Â  Â  const currentLightness = Math.round(100 - (100 - TARGET_LIGHTNESS) * progress);

Â  Â  Â  Â  Â  Â  if (progress === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  root.style.setProperty('--face-color', 'transparent');
Â  Â  Â  Â  Â  Â  Â  Â  container.style.boxShadow = 'none';Â 
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  const hslColor = `hsl(${TARGET_HUE}, ${currentSaturation}%, ${currentLightness}%)`;
Â  Â  Â  Â  Â  Â  Â  Â  root.style.setProperty('--face-color', hslColor);
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // è°ƒæ•´é˜´å½±å‚æ•°ï¼Œä½¿å…¶æ›´æ¨¡ç³Šã€æŸ”å’Œ
Â  Â  Â  Â  Â  Â  Â  Â  const shadowOffsetY = 4 * progress; // å‚ç›´åç§»é‡
Â  Â  Â  Â  Â  Â  Â  Â  const shadowBlur = 15 + 10 * progress; // æ¨¡ç³ŠåŠå¾„ï¼Œä»15åˆ°25
Â  Â  Â  Â  Â  Â  Â  Â  const shadowSpread = 0; // æ‰©æ•£åŠå¾„ä¿æŒ0æˆ–å¾ˆå°
Â  Â  Â  Â  Â  Â  Â  Â  const shadowOpacity = 0.1 + 0.2 * progress; // é€æ˜åº¦ä»0.1åˆ°0.3

Â  Â  Â  Â  Â  Â  Â  Â  container.style.boxShadow = `0 ${shadowOffsetY}px ${shadowBlur}px ${shadowSpread}px rgba(0, 0, 0, ${shadowOpacity})`;Â 
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  // è¡°å‡é€»è¾‘ï¼Œæ¯ç§’è¿è¡Œä¸€æ¬¡
Â  Â  Â  Â  function updateDecay() {
Â  Â  Â  Â  Â  Â  if (clickCount <= 0) {
Â  Â  Â  Â  Â  Â  Â  Â  clickCount = 0;Â 
Â  Â  Â  Â  Â  Â  Â  Â  clearInterval(decayInterval);
Â  Â  Â  Â  Â  Â  Â  Â  decayInterval = null;
Â  Â  Â  Â  Â  Â  Â  Â  updateColor();Â 
Â  Â  Â  Â  Â  Â  Â  Â  saveState();Â 
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  const stepsToDecay = 1 * DECAY_RATE_PER_SEC;Â 

Â  Â  Â  Â  Â  Â  clickCount = Math.max(0, clickCount - stepsToDecay);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  updateColor();
Â  Â  Â  Â  Â  Â  saveState();Â 
Â  Â  Â  Â  }

        // --- Blynk API é€»è¾‘å‡½æ•° (æ ¸å¿ƒä¿®æ”¹) ---
        /**
         * æ„é€ å¹¶å‘é€ HTTP GET è¯·æ±‚åˆ° Blynk APIï¼Œå¹¶ç«‹å³é‡ç½®äº‘ç«¯çŠ¶æ€
         * @param {number} value è¦è®¾ç½®çš„èˆµæœºè§’åº¦ (åº”ä¸º 120)
         */
        async function sendCommand(value) { 
            // æ„é€  PUSH URL (å‘é€ 120 åº¦)
            const url_push = `https://${BLYNK_HOST}/external/api/update?token=${AUTH_TOKEN}&${VIRTUAL_PIN}=${value}`;
            
            // æ„é€  RESET URL (å‘é€ 0 åº¦ï¼Œé‡ç½®äº‘ç«¯çŠ¶æ€)
            const url_reset = `https://${BLYNK_HOST}/external/api/update?token=${AUTH_TOKEN}&${VIRTUAL_PIN}=${RETURN_ANGLE}`;

            blynkStatusElement.innerText = `Blynk Status: Sending ${value} degrees...`;

            try {
                // 1. å‘é€ PUSH å‘½ä»¤ (120åº¦)
                let response_push = await fetch(url_push);
                
                if (!response_push.ok) {
                    blynkStatusElement.innerText = `Blynk Status: PUSH Failed! (Code: ${response_push.status})`;
                    console.error('PUSH API request failed:', response_push.statusText);
                    return; 
                }
                blynkStatusElement.innerText = `Blynk Status: PUSH Success. Resetting cloud...`;

                // 2. å‘é€ RESET å‘½ä»¤ (0åº¦) ä»¥é‡ç½®äº‘ç«¯ V1 çŠ¶æ€
                let response_reset = await fetch(url_reset);

                if (response_reset.ok) {
                    blynkStatusElement.innerText = `Blynk Status: Command ${value}Â° Sent & Cloud Reset Successfully!`;
                    console.log(`Command ${value} sent, and cloud state successfully reset to 0.`);
                } else {
                     blynkStatusElement.innerText = `Blynk Status: PUSH Success, but RESET Failed! (Code: ${response_reset.status})`;
                    console.error('RESET API request failed:', response_reset.statusText);
                }

            } catch (error) {
                blynkStatusElement.innerText = `Blynk Status: Network Error! Could not reach Blynk.`;
                console.error('Network error:', error);
            }
        }


Â  Â  Â  Â  // --- äº‹ä»¶å¤„ç†å‡½æ•° (å·²ä¿®æ”¹) ---
Â  Â  Â  Â  function handleClickEffect(event) {
Â  Â  Â  Â  Â  Â  event.preventDefault(); // é˜»æ­¢é»˜è®¤çš„è§¦æ‘¸è¡Œä¸º

            // 1. è§¦å‘ Blynk èˆµæœºåŠ¨ä½œ
            sendCommand(PICKUP_ANGLE); // å‘é€ 120åº¦ æŒ‡ä»¤
            
            // 2. è§¦å‘è¡¨æƒ…æ‘‡æ™ƒåŠ¨ç”»
Â  Â  Â  Â  Â  Â  container.classList.remove('click-shake');
Â  Â  Â  Â  Â  Â  void container.offsetWidth;Â 
Â  Â  Â  Â  Â  Â  container.classList.add('click-shake');
Â  Â  Â  Â  Â  Â Â 
            // 3. æ›´æ–°é¢œè‰²å’ŒçŠ¶æ€è®°å¿†
Â  Â  Â  Â  Â  Â  clickCount = Math.min(MAX_CLICKS, clickCount + 1);
Â  Â  Â  Â  Â  Â  updateColor();
Â  Â  Â  Â  Â  Â  saveState();Â 
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (!decayInterval) {
Â  Â  Â  Â  Â  Â  Â  Â  decayInterval = setInterval(updateDecay, 1000);Â 
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  // ç»Ÿä¸€å¤„ç†äº”å®˜ä½ç§»å’Œèšæ‹¢ (mousemove/touchmove)
Â  Â  Â  Â  function handleInteraction(event) {
Â  Â  Â  Â  Â  Â  event.preventDefault();

Â  Â  Â  Â  Â  Â  container.classList.remove('click-shake');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const clientX = event.clientX || (event.touches ? event.touches[0].clientX : event.clientX);
Â  Â  Â  Â  Â  Â  const clientY = event.clientY || (event.touches ? event.touches[0].clientY : event.clientX);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (clientX === undefined || clientY === undefined) return;

Â  Â  Â  Â  Â  Â  const containerRect = container.getBoundingClientRect();
Â  Â  Â  Â  Â  Â  const containerCenterX = containerRect.left + containerRect.width / 2;
Â  Â  Â  Â  Â  Â  const containerCenterY = containerRect.top + containerRect.height / 2;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  let dx = clientX - containerCenterX;
Â  Â  Â  Â  Â  Â  let dy = clientY - containerCenterY;

Â  Â  Â  Â  Â  Â  const distance = Math.sqrt(dx * dx + dy * dy);
Â  Â  Â  Â  Â  Â  let moveX = dx;
Â  Â  Â  Â  Â  Â  let moveY = dy;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (distance > maxDistance) {
Â  Â  Â  Â  Â  Â  Â  Â  const ratio = maxDistance / distance;
Â  Â  Â  Â  Â  Â  Â  Â  moveX = dx * ratio;
Â  Â  Â  Â  Â  Â  Â  Â  moveY = dy * ratio;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  const faceMoveX = moveX * -faceShiftRatio;Â 
Â  Â  Â  Â  Â  Â  const faceMoveY = moveY * -faceShiftRatio;Â 
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  container.style.transform = `translate(${faceMoveX}px, ${faceMoveY}px)`;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const maxAbsMove = Math.max(Math.abs(moveX), Math.abs(moveY));Â 
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  let scaleX = 1;
Â  Â  Â  Â  Â  Â  if (Math.abs(moveX) > Math.abs(moveY)) {
Â  Â  Â  Â  Â  Â  Â  Â  const horizontalRatio = Math.abs(moveX) / maxDistance;
Â  Â  Â  Â  Â  Â  Â  Â  scaleX = 1 - (1 - maxSqueezeScale) * horizontalRatio;Â 
Â  Â  Â  Â  Â  Â  } else if (Math.abs(moveY) > 0.01) {
Â  Â  Â  Â  Â  Â  Â  Â  const verticalRatio = Math.abs(moveY) / maxDistance;
Â  Â  Â  Â  Â  Â  Â  Â  scaleX = 1 + (maxStretchScale - 1) * verticalRatio;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  let scaleY = 1;
Â  Â  Â  Â  Â  Â  if (Math.abs(moveY) > Math.abs(moveX)) {
Â  Â  Â  Â  Â  Â  Â  Â  const verticalRatio = Math.abs(moveY) / maxDistance;
Â  Â  Â  Â  Â  Â  Â  Â  scaleY = 1 - (1 - maxSqueezeScale) * verticalRatio;Â 
Â  Â  Â  Â  Â  Â  } else if (Math.abs(moveX) > 0.01) {
Â  Â  Â  Â  Â  Â  Â  Â  const horizontalRatio = Math.abs(moveX) / maxDistance;
Â  Â  Â  Â  Â  Â  Â  Â  scaleY = 1 + (maxStretchScale - 1) * horizontalRatio;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  wrapper.style.transform = `translate(${moveX}px, ${moveY}px) scaleX(${scaleX}) scaleY(${scaleY})`;
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- å¤ä½å‡½æ•° ---
Â  Â  Â  Â  function resetPosition() {
Â  Â  Â  Â  Â  Â  Â wrapper.style.transform = 'translate(0, 0) scaleX(1) scaleY(1)';
Â  Â  Â  Â  Â  Â  Â container.style.transform = 'translate(0, 0)';
Â  Â  Â  Â  Â  Â  Â container.classList.remove('click-shake');
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- çŠ¶æ€åˆå§‹åŒ–é€»è¾‘ï¼ˆç½‘é¡µåŠ è½½æ—¶æ‰§è¡Œï¼‰ ---
Â  Â  Â  Â  function initializeState() {
Â  Â  Â  Â  Â  Â  const savedCount = localStorage.getItem('emojiClickCount');
Â  Â  Â  Â  Â  Â  const lastUpdate = localStorage.getItem('emojiLastUpdateTime');
Â  Â  Â  Â  Â  Â  const currentTime = Date.now();

Â  Â  Â  Â  Â  Â  if (savedCount && lastUpdate) {
Â  Â  Â  Â  Â  Â  Â  Â  let initialCount = parseFloat(savedCount);
Â  Â  Â  Â  Â  Â  Â  Â  const elapsedMs = currentTime - parseInt(lastUpdate);
Â  Â  Â  Â  Â  Â  Â  Â  const elapsedSec = elapsedMs / 1000;

Â  Â  Â  Â  Â  Â  Â  Â  const decayAmount = elapsedSec * DECAY_RATE_PER_SEC;
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  clickCount = Math.max(0, initialCount - decayAmount);
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  clickCount = 0;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  updateColor();Â 

Â  Â  Â  Â  Â  Â  if (clickCount > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  decayInterval = setInterval(updateDecay, 1000);Â 
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- å¯åŠ¨ ---
Â  Â  Â  Â  initializeState();Â 

Â  Â  Â  Â  // ç»‘å®šäº‹ä»¶ï¼š
Â  Â  Â  Â  document.addEventListener('mousemove', handleInteraction);
Â  Â  Â  Â  document.addEventListener('touchmove', handleInteraction);
Â  Â  Â  Â Â 
Â  Â  Â  Â  container.addEventListener('click', handleClickEffect);
Â  Â  Â  Â  container.addEventListener('touchstart', handleClickEffect);Â 

Â  Â  Â  Â  document.addEventListener('mouseup', resetPosition);
Â  Â  Â  Â  document.addEventListener('touchend', resetPosition);
Â  Â  Â  Â  document.addEventListener('touchcancel', resetPosition);
Â  Â  Â  Â  container.addEventListener('contextmenu', (e) => e.preventDefault());Â 

Â  Â  </script>
</body>
</html>
